<source>
  @type forward
</source>

<match fluent.*>
  @type null
</match>

<filter docker.*>
  @type record_transformer
  renew_record true
  keep_keys service
  <record>
    message ${record["log"]}
    @type "#{ENV['HUMIO_DOCKER']}"
    @container ${tag_parts[1]}
    @shipper ${hostname}
  </record>
</filter>

<filter **>
  @type stdout
</filter>

<match **>
  @type elasticsearch
  index_name docker2humio
  type_name docker2humio
  flush_interval 1s
  hosts "#{ENV['HUMIO_HOST']}"
  user "#{ENV['HUMIO_TOKEN']}"
  password ""
  path "/api/v1/dataspaces/#{ENV['HUMIO_DATASPACE']}/ingest/elasticsearch/"
</match>